<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>CamFinder Admin Panel</title>
<style>
body { font-family: Arial, sans-serif; background: #111; color: #eee; }
table { border-collapse: collapse; width: 100%; margin-top: 20px; }
th, td { border: 1px solid #333; padding: 8px; text-align: center; }
th { background: #222; }
tr:nth-child(even) { background: #1a1a1a; }
button { background: #0066ff; border: none; color: white; padding: 5px 10px; border-radius: 4px; cursor: pointer; }
button:hover { background: #0099ff; }
.red { background: #ff3b30; }
.orange { background: #ff9500; }
.green { background: #34c759; }
.gray { background: #777; }
</style>
<script>
async function action(device_id, act, pwd) {
  const resp = await fetch(`/admin/action?pwd=${pwd}`, {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ device_id: device_id, action: act })
  });
  const data = await resp.json();
  alert(data.msg || data.error || 'OK');
  location.reload();
}
</script>
</head>
<body>
<h2>CamFinder Admin Panel</h2>
<table>
<tr>
<th>ID</th><th>–ü–æ–¥–ø–∏—Å–∫–∞</th><th>–ò—Å—Ç–µ–∫–∞–µ—Ç</th><th>–ë–µ—Å–ø–ª–∞—Ç–Ω–æ</th><th>–ü–æ—Å–ª–µ–¥–Ω—è—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</th><th>–î–µ–π—Å—Ç–≤–∏—è</th>
</tr>
{% for d in devices %}
<tr>
<td>{{ d.device_id }}</td>
<td>{{ '‚úÖ –ê–∫—Ç–∏–≤–Ω–∞' if d.active else '‚ùå –ù–µ—Ç' }}</td>
<td>{{ d.expires_at or '-' }}</td>
<td>{{ d.free_left }}</td>
<td>{{ d.last_seen or '-' }}</td>
<td>
<button class="green" onclick="action('{{d.device_id}}','activate_30d','{{pwd}}')">+30–¥</button>
<button class="red" onclick="action('{{d.device_id}}','remove_sub','{{pwd}}')">–£–¥–∞–ª–∏—Ç—å</button>
<button class="orange" onclick="action('{{d.device_id}}','reset_free','{{pwd}}')">0</button>
<button class="gray" onclick="action('{{d.device_id}}','give_free3','{{pwd}}')">3</button>
<button class="green" onclick="action('{{d.device_id}}','dev_mode','{{pwd}}')">Dev</button>
<button class="red" onclick="action('{{d.device_id}}','delete_device','{{pwd}}')">üóë</button>
</td>
</tr>
{% endfor %}
</table>
</body>
</html>
